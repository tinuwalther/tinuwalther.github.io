---
layout: post
title:  "PSHTML"
author: Tinu
categories: "PowerShell-Module"
tags:   PowerShell
permalink: /posts/:title:output_ext
---

# Table of Contents

- [Table of Contents](#table-of-contents)
- [PSHTML](#pshtml)
- [Installation](#installation)
- [Example PSHTML processes](#example-pshtml-processes)

# PSHTML

PSHTML is a cross platform Powershell module to generate HTML markup language written by [St√©phane van Gulick](http://powershelldistrict.com/). You can find PSHTML documentation [here](https://pshtml.readthedocs.io/en/latest/).

![PSHTML processes report](../assets/PSHTMLprocess.png)

# Installation

[Download from PSGallery](https://www.powershellgallery.com/packages/PSHTML/0.7.11)

Import Module:  

````powershell
Import-Module PSHTML
````

List all ExportedCommands:  

````powershell
Get-Command -Module PSHTML
````

# Example PSHTML processes

````powershell
<#
    https://getbootstrap.com/
#>

function Get-MWAProcess{
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [Int] $count
    )

    return Get-Process | `
        Select-Object Id,Name,Starttime,Path,PrivateMemorySize64,WorkingSet64 | `
        Sort-Object WorkingSet64 -Descending | `
        Select-Object -First $count
}

if(-not(Get-Module -Name PSHTML)){
    Import-Module PSHTML
}

$PieCanvasID      = "piecanvas"
$DoughnutCanvasID = "Doughnutcanvas"
$BarCanvasID      = "barcanvas"

$HTML = html {

    head{

        title "PSHTML-Process"
        Write-PSHTMLAsset -Name Jquery
        Write-PSHTMLAsset -Name BootStrap
        Write-PSHTMLAsset -Name Chartjs

        div -Class "container" {
            p -Class "border" {
                h1 "PSHTML processes"
            }
        }
    } 

    body{

        $process = Get-MWAProcess -count 5
        $process | ForEach-Object {
            $total += $_.WorkingSet64
        }

        div -Class "container" {

            p {
                "List most resource-intensive processes"
            }

            p {
                h2 "Summary"
            }

            div -Class "table-responsive" {
                Table {
                    Thead {
                        Th {canvas -Height 300px -Width 300px -Id $PieCanvasID {}}
                        Th {canvas -Height 300px -Width 300px -Id $BarCanvasID {}}
                        Th {canvas -Height 300px -Width 300px -Id $DoughnutCanvasID {}}
                    }
                }
            }
            script -content {

                $data   = $process | Group-Object Name
                $counts = $data | ForEach-Object {$_.Count}
                $labels = $data.Name
                $colors = @("yellow","red","green","orange","blue")
                
                $dsp1   = New-PSHTMLChartPieDataSet -Data $counts -BackgroundColor $colors
                New-PSHTMLChart -type pie -DataSet $dsp1 -title "$($process.count) most resource-intensive processes" -Labels $labels -CanvasID $PieCanvasID 

                $dsb1 = New-PSHTMLChartBarDataSet -Data $counts -BackgroundColor "blue"
                New-PSHTMLChart -type bar -DataSet $dsb1 -title "$($process.count) most resource-intensive processes" -Labels $labels -CanvasID $BarCanvasID 

                $dsd1 = New-PSHTMLChartDoughnutDataSet -Data $counts backgroundcolor $colors -hoverbackgroundColor $Colors
                New-PSHTMLChart -Type doughnut -DataSet $dsd1 -title "$($process.count) most resource-intensive processes" -Labels $labels -CanvasID $DoughnutCanvasID 

            }
        
            p {
                h2 "Details"
            }

            div -Class "table-responsive" {

                Table -Class "table table-hover table-sm" -content {

                    Thead -Class "thead-dark" {

                        Th {"PID"}
                        Th {"Name"}
                        Th {"Path"}
                        Th {"StartTime"}
                        Th {"Commit (KB)"}
                        Th {"Working Set (KB)"}

                    }

                    Tbody {

                        $process | ForEach-Object {

                            tr {
                                td {$_.Id}
                                td {$_.Name}
                                td {$_.Path}
                                td {$_.StartTime}
                                td {"{0:N0}" -f ([math]::Round(($_.PrivateMemorySize64)/1kb))}
                                td {"{0:N0}" -f ([math]::Round(($_.WorkingSet64)/1kb))}
                            }

                        }

                    }

                    #ConvertTo-PSHTMLtable -Object $process
                }

                p -Class "font-weight-bold" {
                    "This $($process.count) processes use {0:N0} MB Memory" -f ([math]::Round(($total)/1mb))
                }

            }

        }

    }

    Footer {

        div -Class "container" {
            p {
                a "Visite me on github.io" -href "https://tinuwalther.github.io/" -Target "_blank"
            }
        }

    }
}

$Path = "$($HOME)\example.html"
$Html | Out-File -FilePath $Path -Encoding utf8
Start-Process $Path 
````

[ [Top] ](#table-of-contents)