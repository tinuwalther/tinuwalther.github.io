---
layout: post
title:  "Powershell Regex"
author: Tinu
categories: "PowerShell-Basic"
tags:   PowerShell
permalink: /posts/:title:output_ext
---

# Table of Contents

- [Table of Contents](#table-of-contents)
- [Regex Pattern](#regex-pattern)
- [Commandlets](#commandlets)
- [Example](#example)
  - [Code](#code)
  - [Output](#output)
- [See also](#see-also)

# Regex Pattern

````powershell
\d digit [0-9]
\w alpha numeric [a-zA-Z0-9_]
\s whitespace character
.  any character except newline
() sub-expression
\  escape the next character
````

# Commandlets

````powershell
Get-Content
Select-String
Select-Object
Split
Replace
````

# Example

From a MemoryDump I returned the Crash-date as Sun May 28 00:30:51.221 2017 (UTC + 2:00), but I need a normal DateTime-Object, so wtf should I do?  

**Do It with RegEx!!!** Copy the string to [regex101.com](https://regex101.com/) and test the regex-string you should use.

## Code

````powershell
$ContentString   = 'Sun May 28 00:30:51.221 2017 (UTC + 2:00)'
$FullRegexString = '^\w{1,3}\s\w{1,3}\s\d{1,2}\s\d{1,2}\:\d{1,2}\:\d{1,2}\.\d{1,3}\s\d{4}'

$RegexDayMonth = '^\w{1,3}\s\w{1,3}\s\d{1,2}'
$RegexYear     = '\s\d{4}\s'
$RegexTime     = '\d{1,2}\:\d{1,2}\:\d{1,2}\.\d{1,3}'

$DayMonthString   = $ContentString | Select-String -Pattern $RegexDayMonth -AllMatches | `
 Select-Object -ExpandProperty matches | Select-Object -ExpandProperty value
$YearString       = $ContentString | Select-String -Pattern $RegexYear     -AllMatches | `
 Select-Object -ExpandProperty matches | Select-Object -ExpandProperty value
$TimeString       = $ContentString | Select-String -Pattern $RegexTime     -AllMatches | `
 Select-Object -ExpandProperty matches | Select-Object -ExpandProperty value

$DateTimeString = $DayMonthString + $YearString + $TimeString -join ' '

Get-Date($DateTimeString)
````

## Output

````text
Sonntag, 28. Mai 2017 00:30:51
````

# See also

[Powershell: The many ways to use regex](https://powershellexplained.com/2017-07-31-Powershell-regex-regular-expression/?utm_source=blog&utm_medium=blog&utm_content=popref) on Kevin Marquette Blog.

[ [Top](#table-of-contents) ] [ [Blog](../categories.html) ]