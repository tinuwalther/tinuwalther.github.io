---
layout: post
title:  "Memory Dump"
author: Tinu
categories: "System-Engineering"
tags:   PowerShell
permalink: /posts/:title:output_ext
---

# Table of Contents

- [Table of Contents](#table-of-contents)
- [Analyze Memory Dump](#analyze-memory-dump)
- [See also](#see-also)

# Analyze Memory Dump

PowerShell Script to analyze a Memory-Dump.

````powershell
<#
	.SYNOPSIS
		Load the Windows Debugger
	.DESCRIPTION
		This function will load the Windows Debugger to analyze a MemoryDump
	 
	.NOTES
		-Author: Martin Walther
		-Email : 
		-CreationDate: 07.04.2017
		-LastModifiedDate: 
		-Version: 1.0.0.00002
		-History:
	.LINK
		https://www.ssisg.com/galaxy/knowledgebase.php?action=displayarticle&id=85
	
#>
$winkitpath = "D:\Program Files (x86)\Windows Kits\8.1"
if(Test-Path -Path "$($winkitpath)\Debuggers\x64")
{
    Set-Location "$($winkitpath)\Debuggers\x64"
    Clear-Host
    write-output ("*******************************************************************************")
    write-output ("*")
    Write-Output ("*                            Load Windows Debugger                             ")
    write-output ("*")
    write-output ("*******************************************************************************")
    Get-ChildItem (Split-Path -Parent $MyInvocation.MyCommand.Path) -Filter *.dmp | Select LastWriteTime,Fullname | ft -AutoSize
    write-output ("")
    $dumpfile   = $(read-host "Enter the full-filename of the memory-dump")
	if($dumpfile.StartsWith('"'))
    {
        $dumpfile = $dumpfile.Trim('"')
    }
    if(Test-Path -Path $dumpfile)
    {
        Write-Output ("Analyze $($dumpfile), please wait . . .")
        $ret = .\kd.exe -y "srv*$($winkitpath)\debugsymbols*http://msdl.microsoft.com/download/symbols" -z $dumpfile -logo out.txt -c "!analyze -v;q"
        $ret | Out-File "$($dumpfile).log"
        Write-Output ("`nAnalysis result:")
        $ret -match "Probably caused by"
        $ret -match "IMAGE_NAME:"
        $ret -match "SYMBOL_NAME:"
        $ret -match "PROCESS_NAME:"
        $ret -match "BUGCHECK_STR:"
        Write-Output ("`nBugcheck Analysis saved to $($dumpfile).log")
        if(Test-Path -Path "$($dumpfile).log")
        {
			$delete = Read-Host "Would you delete the $($dumpfile) [Y] Yes, [N] No"
			if($delete -match '^y')
			{
	            Remove-Item -Path $dumpfile -Force
	            Write-Output ("Memory Dump $($dumpfile) deleted.")
			}
        }
    }
    else
    {
        Write-Output "Warning: File $($dumpfile) not found, could not analyze dumpfile."
    }
}
else
{
    Write-Output "Warning: File $($winkitpath) not found, could not start Windows Debugger."
}
````

# See also

[Analyze crash dump files by using WinDbg]([https://](https://docs.microsoft.com/en-gb/windows-hardware/drivers/debugger/crash-dump-files).

[ [Top](#table-of-contents) ] [ [Blog](../categories.html) ]