---
layout: post
title:  "Function"
author: Tinu
categories: "PowerShell-Basic"
tags:   PowerShell
permalink: /posts/:title:output_ext
---

# Table of Contents

- [Table of Contents](#table-of-contents)
- [Function with parameters](#function-with-parameters)
- [Function with Object](#function-with-object)
- [See also](#see-also)

# Function with parameters

A function which returns an object, either if an error occure or not. Set in the Function-name your Prefix after the verb.

````powershell
<#
.SYNOPSIS
Short description

.DESCRIPTION
Long description

.EXAMPLE
An example

.NOTES
General notes
#>
function Get-MWASomething{
    [CmdletBinding()]
    param(
        [ValidateSet("Medium","Hot","Extra Hot")]
        [Parameter(Mandatory=$true)]
        [String] $Spice,

        [Parameter(Mandatory=$true)]
        [Int] $Timeout,

        [Parameter(Mandatory=$true)]
        [Switch] $Fire
    )
    $function = $($MyInvocation.MyCommand.Name)
    Write-Verbose "Running $function"

    $ret = @()
    try{
        $obj = [PSCustomObject]@{
            Succeeded = $true
            Spice     = $Spice
            Timeout   = $Timeout
            Fire      = $Fire
        }
        $ret += $obj
    }
    catch [Exception]{
        Write-Verbose "-> Catch block reached"
        $obj = [PSCustomObject]@{
            Succeeded  = $false
            Function   = $function
            Activity   = $($_.CategoryInfo).Activity
            Message    = $($_.Exception.Message)
            Category   = $($_.CategoryInfo).Category
            Exception  = $($_.Exception.GetType().FullName)
            TargetName = $($_.CategoryInfo).TargetName
        }
        $ret += $obj
        $error.clear()
    }
    finally{
        Write-Verbose "-> Finally block reached"
    }
    return $ret
}
````

# Function with Object

````powershell
function Get-MWAErrorInEventlog{
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [Object] $args
    )
    $events = Get-WinEvent -MaxEvents 5 -FilterHashtable @{
       Logname   = $args.LogName
       StartTime = [DateTime]$args.StartTime
       EndTime   = [DateTime]$args.EndTime
       Level     = [Int32]$args.Level
    }
    return $events
}

params = @{
    LogName   = 'Microsoft-Windows-WindowsUpdateClient/Operational'
    MaxEvents = 5
    StartTime = (get-date).AddDays(-20)
    EndTime   = get-date
    Level     = 2
}
Get-MWAErrorInEventlog -args $params
````

# See also

[About Functions](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_functions?view=powershell-6) on Microsoft Docs

[ [Top](#table-of-contents) ] [ [Blog](../categories.html) ]