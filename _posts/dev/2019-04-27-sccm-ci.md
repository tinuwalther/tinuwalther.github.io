---
layout: post
title:  "SCCM Automation"
author: Tinu
tags:   PowerShell
permalink: /posts/:title:output_ext
---

# Table of Contents

- [Table of Contents](#table-of-contents)
- [Create automated RegistryKeyValue ConfigurationItem in SCCM](#create-automated-registrykeyvalue-configurationitem-in-sccm)
- [See also](#see-also)

# Create automated RegistryKeyValue ConfigurationItem in SCCM

Cmdlet: Add-CMComplianceSettingRegistryKeyValue

Settings:

- DataType: can be String or Integer
- Hive: can be ClassesRoot, CurrentConfig, CurrentUser, LocalMachine, Users

Rule:

- ExpressionOperator: can be IsEquals, NotEquals, BeginsWith, NotBeginsWith, EndsWith, NotEndsWith, Contains, NotContains, OneOf, NoneOf
- NoncomplianceSeverity: can be None, Informational, Warning, Critical, CriticalWithEvent

````powershell
$CI_Name = 'Automated_CI-RegistryValue'
$ci = Get-CMConfigurationItem -Name $CI_Name -Fast

if(-not($ci)){
    Write-Host "ConfigurationItem $CI_Name will be created" -ForegroundColor Green
    $properties = @{
        Name         = $CI_Name
        Description  = 'The OS ReleaseId should be 1703'
        CreationType = 'WindowsOS'

    }
    $ci = New-CMConfigurationItem @properties

    $properties = @{

        #Settings to test
        SettingName           = 'ReleaseId must exist'
        DataType              = 'String'
        Hive                  = 'LocalMachine'
        KeyName               = "SOFTWARE\Microsoft\Windows NT\CurrentVersion"
        ValueName             = "ReleaseId"

        #Compliance Rule
        ValueRule             = $true
        RuleName              = 'The ReleaseId must be 1703'
        ExpressionOperator    = 'IsEqual'
        ExpectedValue         = "1703"
        ReportNoncompliance   = $true
        NoncomplianceSeverity = 'Warning'

    }
    $null = $ci | Add-CMComplianceSettingRegistryKeyValue @properties
}
````

# See also

[ConfigurationManager](https://docs.microsoft.com/en-us/powershell/module/configurationmanager/?view=sccm-ps) on Microsoft Docs

[System Center Configuration Manager Cmdlet Library](https://docs.microsoft.com/en-US/powershell/sccm/1706_release_notes?view=sccm-ps) on Microsoft Docs

[ [Top](#table-of-contents) ] [ [Blog](../devops.html) ]